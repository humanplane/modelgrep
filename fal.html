<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>modelgrep - Media Models | Image & Video Generation</title>
  <meta name="description" content="Explore image generation, video generation, and more. Compare pricing and capabilities across 400+ media models.">
  <meta name="keywords" content="image generation, video generation, AI models, FLUX, Stable Diffusion, text-to-image, text-to-video, media models">
  <meta name="author" content="modelgrep">
  <meta name="robots" content="index, follow">

  <!-- Open Graph -->
  <meta property="og:title" content="modelgrep - Media Models">
  <meta property="og:description" content="Explore image and video generation models.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://modelgrep.com/media">

  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='20' fill='%237c3aed'/><text x='50' y='68' font-size='50' text-anchor='middle' fill='white' font-family='monospace' font-weight='bold'>M</text></svg>">
  <meta name="theme-color" content="#7c3aed">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Inter', -apple-system, sans-serif;
      background: #0a0a0b;
      color: #e4e4e7;
      min-height: 100vh;
    }

    .layout {
      display: flex;
      min-height: 100vh;
    }

    /* Sidebar */
    .sidebar {
      width: 200px;
      background: #0f0f11;
      border-right: 1px solid #1f1f23;
      padding: 20px 12px;
      display: flex;
      flex-direction: column;
      position: fixed;
      top: 0;
      left: 0;
      height: 100vh;
      overflow-y: auto;
    }

    .logo {
      font-family: 'JetBrains Mono', monospace;
      font-size: 15px;
      font-weight: 600;
      color: #fff;
      padding: 0 8px;
      margin-bottom: 8px;
      text-decoration: none;
      display: block;
    }

    .logo:hover { color: #a78bfa; }

    .logo-sub {
      font-size: 11px;
      color: #f97316;
      padding: 0 8px;
      margin-bottom: 20px;
      font-weight: 500;
    }

    .nav-section { margin-bottom: 16px; }

    .nav-label {
      font-size: 10px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: #52525b;
      padding: 0 8px;
      margin-bottom: 6px;
    }

    .nav-btn {
      display: flex;
      align-items: center;
      justify-content: space-between;
      width: 100%;
      padding: 6px 10px;
      background: none;
      border: none;
      border-radius: 6px;
      font-size: 12px;
      color: #a1a1aa;
      cursor: pointer;
      transition: all 0.15s;
      text-align: left;
    }

    .nav-btn:hover { background: #18181b; color: #e4e4e7; }
    .nav-btn.active { background: #18181b; color: #fff; }

    .nav-badge {
      font-size: 9px;
      font-family: 'JetBrains Mono', monospace;
      color: #52525b;
    }

    .nav-link {
      display: block;
      padding: 6px 10px;
      border-radius: 6px;
      font-size: 12px;
      color: #71717a;
      text-decoration: none;
      transition: all 0.15s;
    }

    .nav-link:hover { background: #18181b; color: #a1a1aa; }

    .sidebar-stats {
      margin-top: auto;
      background: #18181b;
      border-radius: 8px;
      padding: 10px;
    }

    .stat-row {
      display: flex;
      justify-content: space-between;
      font-size: 11px;
      padding: 3px 0;
    }

    .stat-row span:first-child { color: #71717a; }
    .stat-row span:last-child {
      font-family: 'JetBrains Mono', monospace;
      color: #e4e4e7;
    }

    .powered-by {
      margin-top: 12px;
      font-size: 10px;
      color: #52525b;
      padding: 0 8px;
    }

    .powered-by a {
      color: #71717a;
      text-decoration: none;
    }

    .powered-by a:hover {
      color: #a78bfa;
    }

    /* Main Content */
    .main {
      flex: 1;
      margin-left: 200px;
      padding: 20px 24px;
    }

    /* Header Controls */
    .header {
      margin-bottom: 16px;
    }

    .search-box {
      position: relative;
      margin-bottom: 10px;
    }

    .search-box svg {
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      color: #52525b;
    }

    .search-input {
      width: 100%;
      height: 38px;
      background: #18181b;
      border: 1px solid #27272a;
      border-radius: 8px;
      padding: 0 12px 0 38px;
      font-size: 13px;
      color: #e4e4e7;
      outline: none;
    }

    .search-input:focus { border-color: #3f3f46; }
    .search-input::placeholder { color: #52525b; }

    .filters {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      align-items: center;
    }

    .filter-chip {
      display: flex;
      align-items: center;
      gap: 5px;
      height: 30px;
      padding: 0 8px;
      background: #18181b;
      border: 1px solid #27272a;
      border-radius: 6px;
      font-size: 11px;
      color: #a1a1aa;
    }

    .filter-chip input {
      width: 40px;
      background: none;
      border: none;
      color: #e4e4e7;
      font-family: 'JetBrains Mono', monospace;
      font-size: 11px;
      outline: none;
    }

    .filter-chip input::placeholder { color: #52525b; }

    .filter-chip select {
      background: none;
      border: none;
      color: #e4e4e7;
      font-size: 11px;
      outline: none;
      cursor: pointer;
    }

    .filter-chip select option {
      background: #18181b;
      color: #e4e4e7;
    }

    .toggle-btn {
      height: 30px;
      padding: 0 10px;
      background: #18181b;
      border: 1px solid #27272a;
      border-radius: 6px;
      font-size: 11px;
      color: #a1a1aa;
      cursor: pointer;
      transition: all 0.15s;
    }

    .toggle-btn:hover { background: #27272a; }
    .toggle-btn.active { background: #7c3aed20; border-color: #7c3aed; color: #a78bfa; }

    .clear-btn {
      height: 30px;
      padding: 0 10px;
      background: none;
      border: 1px solid #27272a;
      border-radius: 6px;
      font-size: 11px;
      color: #71717a;
      cursor: pointer;
    }

    .clear-btn:hover { border-color: #ef4444; color: #ef4444; }

    /* Results Bar */
    .results-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }

    .results-count {
      font-size: 12px;
      color: #71717a;
    }

    .results-count strong { color: #e4e4e7; }

    .sort-pills {
      display: flex;
      gap: 3px;
      background: #18181b;
      padding: 3px;
      border-radius: 6px;
    }

    .sort-pill {
      padding: 4px 8px;
      background: none;
      border: none;
      border-radius: 4px;
      font-size: 11px;
      color: #71717a;
      cursor: pointer;
    }

    .sort-pill:hover { color: #a1a1aa; }
    .sort-pill.active { background: #27272a; color: #e4e4e7; }

    /* Model Grid */
    .model-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
      gap: 14px;
    }

    .model-card {
      background: #111113;
      border: 1px solid #1f1f23;
      border-radius: 10px;
      overflow: hidden;
      transition: all 0.2s;
    }

    .model-card:hover {
      border-color: #3f3f46;
      transform: translateY(-2px);
    }

    .model-thumb {
      position: relative;
      aspect-ratio: 16/9;
      background: #18181b;
      overflow: hidden;
    }

    .model-thumb img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .model-thumb-placeholder {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #3f3f46;
      font-size: 28px;
    }

    .model-badges {
      position: absolute;
      top: 6px;
      left: 6px;
      display: flex;
      gap: 4px;
      flex-wrap: wrap;
      max-width: calc(100% - 12px);
    }

    .badge {
      font-size: 8px;
      font-weight: 600;
      text-transform: uppercase;
      padding: 2px 5px;
      border-radius: 3px;
      background: rgba(0,0,0,0.75);
      backdrop-filter: blur(4px);
      color: #e4e4e7;
    }

    .badge.featured { background: #7c3aed; color: #fff; }
    .badge.category { background: rgba(249,115,22,0.9); color: #fff; }
    .badge.fast { background: rgba(34,197,94,0.9); color: #fff; }
    .badge.slow { background: rgba(234,179,8,0.9); color: #000; }

    .model-duration {
      position: absolute;
      bottom: 6px;
      right: 6px;
      font-size: 9px;
      font-family: 'JetBrains Mono', monospace;
      padding: 2px 5px;
      border-radius: 3px;
      background: rgba(0,0,0,0.75);
      backdrop-filter: blur(4px);
      color: #a1a1aa;
    }

    .model-content {
      padding: 12px;
    }

    .model-name {
      font-family: 'JetBrains Mono', monospace;
      font-size: 12px;
      color: #e4e4e7;
      margin-bottom: 4px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .model-id {
      font-size: 10px;
      color: #52525b;
      margin-bottom: 6px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .model-desc {
      font-size: 11px;
      color: #71717a;
      line-height: 1.4;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
      margin-bottom: 8px;
      min-height: 30px;
    }

    .model-footer {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 6px;
    }

    .model-tags {
      display: flex;
      gap: 3px;
      flex-wrap: wrap;
      flex: 1;
      overflow: hidden;
      max-height: 20px;
    }

    .tag {
      font-size: 9px;
      padding: 2px 5px;
      border-radius: 3px;
      background: #27272a;
      color: #a1a1aa;
      white-space: nowrap;
    }

    .model-price {
      font-family: 'JetBrains Mono', monospace;
      font-size: 10px;
      color: #22c55e;
      white-space: nowrap;
    }

    .model-price.na { color: #52525b; }

    .model-link {
      display: block;
      text-decoration: none;
      color: inherit;
    }

    /* View Toggle */
    .view-toggle {
      display: flex;
      gap: 2px;
      background: #18181b;
      padding: 2px;
      border-radius: 4px;
      margin-left: 8px;
    }

    .view-btn {
      padding: 4px 8px;
      background: none;
      border: none;
      border-radius: 3px;
      font-size: 11px;
      color: #71717a;
      cursor: pointer;
    }

    .view-btn.active { background: #27272a; color: #e4e4e7; }

    /* Table View */
    .model-table {
      display: none;
      width: 100%;
      border-collapse: collapse;
      background: #111113;
      border: 1px solid #1f1f23;
      border-radius: 10px;
      overflow: hidden;
    }

    .model-table.active { display: table; }
    .model-grid.hidden { display: none; }

    .model-table th {
      padding: 10px 12px;
      text-align: left;
      font-size: 10px;
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: 0.3px;
      color: #52525b;
      background: #0f0f11;
      border-bottom: 1px solid #1f1f23;
    }

    .model-table th.num { text-align: right; }

    .model-table td {
      padding: 10px 12px;
      font-size: 12px;
      border-bottom: 1px solid #1a1a1d;
      vertical-align: middle;
    }

    .model-table td.num {
      text-align: right;
      font-family: 'JetBrains Mono', monospace;
      font-size: 11px;
    }

    .model-table tr:last-child td { border-bottom: none; }
    .model-table tr:hover { background: #151517; }

    .table-thumb {
      width: 48px;
      height: 27px;
      border-radius: 4px;
      object-fit: cover;
      background: #18181b;
    }

    .table-name {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .table-name-text {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .table-model-name {
      font-family: 'JetBrains Mono', monospace;
      font-size: 12px;
      color: #e4e4e7;
    }

    .table-model-id {
      font-size: 10px;
      color: #52525b;
    }

    /* Empty/Loading */
    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: #52525b;
    }

    .spinner {
      width: 24px;
      height: 24px;
      margin: 0 auto 12px;
      border: 2px solid #27272a;
      border-top-color: #7c3aed;
      border-radius: 50%;
      animation: spin 0.6s linear infinite;
    }

    @keyframes spin { to { transform: rotate(360deg); } }

    /* Toast */
    .toast {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%) translateY(80px);
      padding: 10px 16px;
      background: #18181b;
      border: 1px solid #27272a;
      border-radius: 8px;
      font-size: 13px;
      opacity: 0;
      transition: all 0.2s;
      z-index: 100;
    }

    .toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }

    /* Mobile */
    @media (max-width: 768px) {
      .sidebar { display: none; }
      .main { margin-left: 0; padding: 12px; }
      .model-grid { grid-template-columns: 1fr; }
      .filters { gap: 4px; }
      .filter-chip, .toggle-btn { height: 28px; font-size: 10px; }
    }
  </style>
</head>
<body>
  <div class="layout">
    <aside class="sidebar">
      <a href="/" class="logo">modelgrep</a>
      <div class="logo-sub">Media Models</div>

      <nav class="nav-section">
        <div class="nav-label">Categories</div>
        <button class="nav-btn active" data-category="all">All Models</button>
        <button class="nav-btn" data-category="text-to-image">Text to Image</button>
        <button class="nav-btn" data-category="image-to-image">Image to Image</button>
        <button class="nav-btn" data-category="text-to-video">Text to Video</button>
        <button class="nav-btn" data-category="image-to-video">Image to Video</button>
        <button class="nav-btn" data-category="video-to-video">Video to Video</button>
      </nav>

      <nav class="nav-section">
        <div class="nav-label">More Types</div>
        <button class="nav-btn" data-category="text-to-speech">Text to Speech</button>
        <button class="nav-btn" data-category="audio-to-text">Speech to Text</button>
        <button class="nav-btn" data-category="text-to-3d">Text to 3D</button>
        <button class="nav-btn" data-category="image-to-3d">Image to 3D</button>
        <button class="nav-btn" data-category="training">Training</button>
      </nav>

      <nav class="nav-section">
        <div class="nav-label">Navigate</div>
        <a href="/" class="nav-link">LLM Models</a>
      </nav>

      <div class="sidebar-stats">
        <div class="stat-row"><span>Models</span><span id="stat-models">--</span></div>
        <div class="stat-row"><span>Categories</span><span id="stat-cats">--</span></div>
        <div class="stat-row"><span>Featured</span><span id="stat-featured">--</span></div>
      </div>

      <div class="powered-by">
        Powered by <a href="https://fal.ai" target="_blank" rel="noopener">fal.ai</a>
      </div>
    </aside>

    <main class="main">
      <div class="header">
        <div class="search-box">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/>
          </svg>
          <input type="text" class="search-input" id="search" placeholder="Search models, tags... (press /)">
        </div>
        <div class="filters">
          <div class="filter-chip">
            <span>Speed</span>
            <select id="f-speed">
              <option value="all">All</option>
              <option value="fast">Fast (&lt;5s)</option>
              <option value="medium">Medium (5-30s)</option>
              <option value="slow">Slow (&gt;30s)</option>
            </select>
          </div>
          <div class="filter-chip">
            <span>License</span>
            <select id="f-license">
              <option value="all">All</option>
              <option value="commercial">Commercial</option>
              <option value="research">Research</option>
            </select>
          </div>
          <button class="toggle-btn" id="t-featured">Featured</button>
          <button class="toggle-btn" id="t-video">Video Only</button>
          <button class="toggle-btn" id="t-image">Image Only</button>
          <button class="clear-btn" id="clear">Clear</button>
        </div>
      </div>

      <div class="results-bar">
        <div class="results-count"><strong id="count">0</strong> models</div>
        <div style="display:flex;align-items:center;">
          <div class="sort-pills">
            <button class="sort-pill active" data-sort="pinned" data-desc="1">Featured</button>
            <button class="sort-pill" data-sort="name">Name</button>
            <button class="sort-pill" data-sort="updated_at" data-desc="1">Recent</button>
            <button class="sort-pill" data-sort="duration_estimate">Speed</button>
          </div>
          <div class="view-toggle">
            <button class="view-btn active" data-view="grid">Grid</button>
            <button class="view-btn" data-view="table">Table</button>
          </div>
        </div>
      </div>

      <div class="model-grid" id="grid">
        <div class="empty-state"><div class="spinner"></div>Loading media models...</div>
      </div>

      <table class="model-table" id="table">
        <thead>
          <tr>
            <th>Model</th>
            <th>Category</th>
            <th class="num">Est. Time</th>
            <th>Tags</th>
            <th>License</th>
          </tr>
        </thead>
        <tbody id="tbody"></tbody>
      </table>
    </main>
  </div>

  <div class="toast" id="toast"></div>

  <script>
    let models = [], sort = 'pinned', sortDesc = true, currentCategory = 'all', viewMode = 'grid';
    const $ = s => document.querySelector(s);
    const $$ = s => document.querySelectorAll(s);

    function toast(m) {
      const t = $('#toast');
      t.textContent = m;
      t.classList.add('show');
      setTimeout(() => t.classList.remove('show'), 2000);
    }

    async function load() {
      try {
        const [mr, sr] = await Promise.all([
          fetch('/api/media/models?limit=1000'),
          fetch('/api/media/stats')
        ]);
        const md = await mr.json(), sd = await sr.json();

        if (md.loading || sd.loading) {
          $('#grid').innerHTML = '<div class="empty-state">Loading media models...</div>';
          setTimeout(load, 2000);
          return;
        }

        models = md.models;
        $('#stat-models').textContent = sd.total_models;
        $('#stat-cats').textContent = Object.keys(sd.categories || {}).length;
        $('#stat-featured').textContent = sd.highlighted || 0;

        // Update category counts
        const cats = sd.categories || {};
        $$('.nav-btn[data-category]').forEach(btn => {
          const cat = btn.dataset.category;
          if (cat !== 'all' && cats[cat]) {
            let badge = btn.querySelector('.nav-badge');
            if (!badge) {
              badge = document.createElement('span');
              badge.className = 'nav-badge';
              btn.appendChild(badge);
            }
            badge.textContent = cats[cat];
          }
        });

        filter();
      } catch(e) {
        console.error(e);
        $('#grid').innerHTML = '<div class="empty-state">Failed to load media models</div>';
      }
    }

    function getFilters() {
      return {
        q: $('#search').value.toLowerCase(),
        license: $('#f-license').value,
        speed: $('#f-speed').value,
        featured: $('#t-featured').classList.contains('active'),
        videoOnly: $('#t-video').classList.contains('active'),
        imageOnly: $('#t-image').classList.contains('active'),
        category: currentCategory
      };
    }

    function matchesSpeed(m, speedFilter) {
      if (speedFilter === 'all') return true;
      const dur = m.duration_estimate;
      if (dur == null) return speedFilter === 'slow'; // Unknown = assume slow
      if (speedFilter === 'fast') return dur <= 5;
      if (speedFilter === 'medium') return dur > 5 && dur <= 30;
      if (speedFilter === 'slow') return dur > 30;
      return true;
    }

    function isVideoCategory(cat) {
      return ['text-to-video', 'image-to-video', 'video-to-video', 'audio-to-video'].includes(cat);
    }

    function isImageCategory(cat) {
      return ['text-to-image', 'image-to-image'].includes(cat);
    }

    function filter() {
      const f = getFilters();
      const terms = f.q.split(/\s+/).filter(t => t.length > 0);

      let list = models.filter(m => {
        // Search
        if (terms.length > 0) {
          const text = (m.id + ' ' + m.name + ' ' + (m.description || '') + ' ' + (m.tags || []).join(' ')).toLowerCase();
          if (!terms.some(t => text.includes(t))) return false;
        }
        // Category
        if (f.category !== 'all' && m.category !== f.category) return false;
        // License
        if (f.license !== 'all' && m.license !== f.license) return false;
        // Speed
        if (!matchesSpeed(m, f.speed)) return false;
        // Featured
        if (f.featured && !m.highlighted) return false;
        // Video/Image only
        if (f.videoOnly && !isVideoCategory(m.category)) return false;
        if (f.imageOnly && !isImageCategory(m.category)) return false;
        return true;
      });

      // Sort
      list.sort((a, b) => {
        let av = a[sort], bv = b[sort];
        // Handle nulls
        if (av == null) av = sortDesc ? -Infinity : Infinity;
        if (bv == null) bv = sortDesc ? -Infinity : Infinity;
        // Boolean sort
        if (typeof av === 'boolean') av = av ? 1 : 0;
        if (typeof bv === 'boolean') bv = bv ? 1 : 0;
        // String sort
        if (typeof av === 'string') {
          return sortDesc ? bv.localeCompare(av) : av.localeCompare(bv);
        }
        return sortDesc ? bv - av : av - bv;
      });

      render(list);
    }

    function formatDuration(d) {
      if (d == null) return '--';
      if (d < 1) return '<1s';
      if (d < 60) return Math.round(d) + 's';
      return Math.round(d / 60) + 'm';
    }

    function getSpeedClass(d) {
      if (d == null) return '';
      if (d <= 5) return 'fast';
      if (d > 30) return 'slow';
      return '';
    }

    function getCategoryLabel(cat) {
      const labels = {
        'text-to-image': 'T2I',
        'image-to-image': 'I2I',
        'text-to-video': 'T2V',
        'image-to-video': 'I2V',
        'video-to-video': 'V2V',
        'audio-to-video': 'A2V',
        'text-to-speech': 'TTS',
        'audio-to-text': 'STT',
        'audio-to-audio': 'A2A',
        'text-to-3d': 'T23D',
        'image-to-3d': 'I23D',
        '3d-to-3d': '3D',
        'training': 'Train',
        'vision': 'Vision',
        'llm': 'LLM'
      };
      return labels[cat] || cat;
    }

    function getCategoryFull(cat) {
      const labels = {
        'text-to-image': 'Text to Image',
        'image-to-image': 'Image to Image',
        'text-to-video': 'Text to Video',
        'image-to-video': 'Image to Video',
        'video-to-video': 'Video to Video',
        'audio-to-video': 'Audio to Video',
        'text-to-speech': 'Text to Speech',
        'audio-to-text': 'Speech to Text',
        'audio-to-audio': 'Audio to Audio',
        'text-to-3d': 'Text to 3D',
        'image-to-3d': 'Image to 3D',
        '3d-to-3d': '3D to 3D',
        'training': 'Training',
        'vision': 'Vision',
        'llm': 'LLM'
      };
      return labels[cat] || cat;
    }

    function render(list) {
      $('#count').textContent = list.length;

      if (!list.length) {
        $('#grid').innerHTML = '<div class="empty-state">No models match your filters</div>';
        $('#tbody').innerHTML = '<tr><td colspan="5"><div class="empty-state">No models match</div></td></tr>';
        return;
      }

      // Grid view
      $('#grid').innerHTML = list.map(m => {
        const thumb = m.thumbnail_animated_url || m.thumbnail_url;
        const tags = (m.tags || []).slice(0, 3);
        const speedClass = getSpeedClass(m.duration_estimate);

        return `
          <div class="model-card">
            <a class="model-link" href="${m.model_url || `https://fal.ai/models/${m.id}`}" target="_blank" rel="noopener">
              <div class="model-thumb">
                ${thumb
                  ? `<img src="${thumb}" alt="${m.name}" loading="lazy">`
                  : `<div class="model-thumb-placeholder">?</div>`
                }
                <div class="model-badges">
                  ${m.highlighted ? '<span class="badge featured">Featured</span>' : ''}
                  <span class="badge category">${getCategoryLabel(m.category)}</span>
                  ${speedClass === 'fast' ? '<span class="badge fast">Fast</span>' : ''}
                </div>
                ${m.duration_estimate ? `<div class="model-duration">${formatDuration(m.duration_estimate)}</div>` : ''}
              </div>
              <div class="model-content">
                <div class="model-name" title="${m.name}">${m.name}</div>
                <div class="model-id" title="${m.id}">${m.id}</div>
                <div class="model-desc">${m.description || 'No description'}</div>
                <div class="model-footer">
                  <div class="model-tags">
                    ${tags.map(t => `<span class="tag">${t}</span>`).join('')}
                  </div>
                  <span class="tag">${m.license || 'unknown'}</span>
                </div>
              </div>
            </a>
          </div>
        `;
      }).join('');

      // Table view
      $('#tbody').innerHTML = list.map(m => {
        const thumb = m.thumbnail_url;
        const tags = (m.tags || []).slice(0, 2);

        return `
          <tr onclick="window.open('${m.model_url || `https://fal.ai/models/${m.id}`}', '_blank')" style="cursor:pointer">
            <td>
              <div class="table-name">
                ${thumb ? `<img class="table-thumb" src="${thumb}" loading="lazy">` : '<div class="table-thumb"></div>'}
                <div class="table-name-text">
                  <span class="table-model-name">${m.name}</span>
                  <span class="table-model-id">${m.id}</span>
                </div>
              </div>
            </td>
            <td><span class="badge category">${getCategoryFull(m.category)}</span></td>
            <td class="num">${formatDuration(m.duration_estimate)}</td>
            <td>${tags.map(t => `<span class="tag">${t}</span>`).join(' ')}</td>
            <td><span class="tag">${m.license || '--'}</span></td>
          </tr>
        `;
      }).join('');
    }

    function clearAll() {
      $('#search').value = '';
      $('#f-license').value = 'all';
      $('#f-speed').value = 'all';
      $('#t-featured').classList.remove('active');
      $('#t-video').classList.remove('active');
      $('#t-image').classList.remove('active');
      currentCategory = 'all';
      $$('.nav-btn[data-category]').forEach(n => n.classList.remove('active'));
      $('.nav-btn[data-category="all"]').classList.add('active');
      filter();
    }

    function setCategory(cat) {
      currentCategory = cat;
      $$('.nav-btn[data-category]').forEach(n => n.classList.remove('active'));
      $(`.nav-btn[data-category="${cat}"]`)?.classList.add('active');
      // Clear video/image toggles when selecting specific category
      $('#t-video').classList.remove('active');
      $('#t-image').classList.remove('active');
      filter();
    }

    function setView(mode) {
      viewMode = mode;
      $$('.view-btn').forEach(b => b.classList.remove('active'));
      $(`.view-btn[data-view="${mode}"]`).classList.add('active');
      if (mode === 'grid') {
        $('#grid').classList.remove('hidden');
        $('#table').classList.remove('active');
      } else {
        $('#grid').classList.add('hidden');
        $('#table').classList.add('active');
      }
    }

    // Events
    let db;
    $('#search').addEventListener('input', () => { clearTimeout(db); db = setTimeout(filter, 80); });
    $('#f-license').addEventListener('change', filter);
    $('#f-speed').addEventListener('change', filter);

    $('#t-featured').onclick = function() { this.classList.toggle('active'); filter(); };
    $('#t-video').onclick = function() {
      this.classList.toggle('active');
      if (this.classList.contains('active')) $('#t-image').classList.remove('active');
      filter();
    };
    $('#t-image').onclick = function() {
      this.classList.toggle('active');
      if (this.classList.contains('active')) $('#t-video').classList.remove('active');
      filter();
    };
    $('#clear').onclick = clearAll;

    $$('.sort-pill').forEach(t => {
      t.onclick = () => {
        $$('.sort-pill').forEach(x => x.classList.remove('active'));
        t.classList.add('active');
        sort = t.dataset.sort;
        sortDesc = t.dataset.desc === '1';
        filter();
      };
    });

    $$('.nav-btn[data-category]').forEach(n => {
      n.onclick = () => setCategory(n.dataset.category);
    });

    $$('.view-btn').forEach(b => {
      b.onclick = () => setView(b.dataset.view);
    });

    document.addEventListener('keydown', e => {
      if (e.key === '/' && !e.target.matches('input, textarea, select')) {
        e.preventDefault();
        $('#search').focus();
      }
      if (e.key === 'Escape') clearAll();
    });

    load();
  </script>
</body>
</html>
